<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>About • Agrovoltaicos sin Fronteras</title>
    <meta name="description"
        content="Learn about the Agrovoltaicos sin Fronteras seminar series." />
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600&family=Lato:wght@400;700&family=Poppins:wght@700;800&display=swap"
        rel="stylesheet">
    <style>
        /* --- CORE PAGE LAYOUT --- */
        body {
            min-height: 100vh;
        }

        main.container {
            flex-grow: 1;
            padding: var(--space-5);
            box-sizing: border-box;
            max-width: none;
            width: 100%;
        }

        /* --- STYLING FOR CONTENT WITHIN THE FLEXIBLE MAIN AREA --- */
        .header-image {
            flex-shrink: 0;
            height: 30vh;
            min-height: 200px;
            width: 100%;
            object-fit: cover;
            border-radius: var(--radius);
            margin-bottom: var(--space-4);
        }

        .content-card {
            display: flex;
            flex-direction: column;
            background-color: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: var(--space-5);
        }


        .content-card h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--brand);
            margin-top: var(--space-4);
            margin-bottom: var(--space-3);
        }

        .lang-content h2:first-of-type {
            margin-top: 0;
        }

        .content-card p {
            line-height: 1.7;
        }

        .content-card a {
            color: var(--brand);
            text-decoration: underline;
            font-weight: 700;
        }

        /* Language content visibility toggle */
        html[lang="en"] .lang-content[lang="en"],
        html[lang="es"] .lang-content[lang="es"] {
            display: flex;
            flex-direction: column;
        }

        .lang-content[lang="en"],
        .lang-content[lang="es"] {
            display: none;
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="container header-grid">
            <div class="brand">
                <a href="index.html" style="display: contents; text-decoration: none;">
                    <img src="static/icon.png" alt="Agrovoltaicos sin Fronteras logo" class="logo-image">
                    <div class="brand-text">
                        <div class="title">Agrovoltaicos sin Fronteras</div>
                        <div class="subtitle" data-i18n="tagline">
                            A seminar series to share advances in agrivoltaics in the Americas
                        </div>
                    </div>
                </a>
            </div>

            <button id="mobileMenuBtn" class="mobile-menu-btn" aria-label="Open menu" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>

            <!-- Desktop Nav -->
            <nav class="nav">
                <a href="index.html" class="link" data-i18n="nav.schedule">Schedule</a>
                <a href="archive.html" class="link" data-i18n="nav.archive">Archive</a>
                <a href="about.html" class="link" data-i18n="nav.about">About</a>
                <a href="admin.html" id="btnAdmin" class="link" data-i18n="nav.admin" style="display: none;">Admin</a>
                <div class="divider"></div>
                <div id="langSwitchDesktop" class="lang-switch-slider" data-lang="en">
                    <span>EN</span>
                    <span>ES</span>
                </div>
                <div class="auth-area">
                    <button id="btnProfile" class="profile-button" style="display: none" aria-label="Open profile">
                        <span id="userInitial"></span>
                        <img id="userAvatar" style="display: none; width: 100%; height: 100%; object-fit: cover;" />
                    </button>
                    <span id="userName"></span>
                    <a href="signin.html" id="btnSignIn" class="btn-primary" data-i18n="auth.signin"
                        style="text-decoration: none; display: inline-block;">Sign in</a>
                    <button id="btnSignOut" class="btn-ghost" data-i18n="auth.signout" style="display: none">
                        Sign out
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <div id="mobileNavOverlay" class="mobile-nav-overlay"></div>

    <div id="flash" class="flash" role="status" aria-live="polite"></div>

    <main class="container">
        <img src="static/agrivUA.jpg" alt="Agrivoltaic solar panels over a field of crops at the University of Arizona"
            class="header-image">
        <div class="content-card">

            <!-- English Content -->
            <div class="lang-content" lang="en">
                <div>
                    <h2>What is Agrivoltaics?</h2>
                    Agrivoltaics is the integration of solar photovoltaics with agricultural production in the same
                    space. Agrivoltaics is a highly diverse field that can include energy production from household to
                    utility scale, and agricultural production from horticulture to field crops to livestock and more.
                    Topics covered in this seminar series will include agrivoltaic system design, crop yield and
                    responses, business models, community engagement, governance and legal frameworks, and much more.

                    <h2>Attend the seminars:</h2>
                    To attend the seminars, simply <a
                        href="https://arizona.zoom.us/meeting/register/rFJXhrYpQL2Vcw30vlxwyA" target="_blank"
                        rel="noopener noreferrer">register here</a> and you will receive the zoom meeting link to your
                    email. This link will work for all future seminars, so you only need to register once.

                    <h2>Contact Us:</h2>
                    Agrovoltaicos sin Fronteras is jointly hosted by UNAM and the University of Arizona. For more
                    information, please contact Christine Lamanna <a
                        href="mailto:clamanna@arizona.edu">clamanna@arizona.edu</a> or XXXX.
                </div>
            </div>

            <!-- Spanish Content -->
            <div class="lang-content" lang="es">
                <div>
                    <h2>¿Qué son los Agrovoltaicos?</h2>
                    <p>
                        Los Agrovoltaicos son la integración de la energía solar fotovoltaica con la producción agrícola
                        en un mismo espacio. Es un campo muy diverso que abarca la producción de energía desde el hogar
                        hasta la escala de servicios públicos, y la producción agrícola desde la horticultura hasta los
                        cultivos extensivos, la ganadería y más. Los temas que se abordarán en esta serie de seminarios
                        incluirán el diseño de sistemas agrovoltaicos, el rendimiento y las respuestas de los cultivos,
                        los modelos de negocio, la participación comunitaria, la gobernanza y los marcos legales, y
                        mucho más.
                    </p>

                    <h2>Asista a los seminarios:</h2>
                    <p>
                        Para asistir a los seminarios, simplemente <a
                            href="https://arizona.zoom.us/meeting/register/rFJXhrYpQL2Vcw30vlxwyA" target="_blank"
                            rel="noopener noreferrer">regístrese aquí</a> y recibirá el enlace de la reunión de Zoom en
                        su correo electrónico. Este enlace funcionará para todos los seminarios futuros, por lo que solo
                        necesita registrarse una vez.
                    </p>

                    <h2>Únase a la comunidad:</h2>
                    <p>
                        Para acceder a charlas anteriores, ver los materiales de las presentaciones o discutir temas en
                        el foro, únase a la <a href="#">comunidad Agrovoltaicos sin Fronteras</a>.
                    </p>

                    <h2>Contáctenos:</h2>
                    <p>
                        Agrovoltaicos sin Fronteras es un evento conjunto de la UNAM y la Universidad de Arizona. Para
                        obtener más información, comuníquese con Christine Lamanna <a
                            href="mailto:clamanna@arizona.edu">clamanna@arizona.edu</a> o XXXX.
                    </p>
                </div>
            </div>

        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <small style="display: flex; justify-content: space-between; align-items: center;">
                <div style="display: flex; align-items: center;">
                    © <span id="year"></span> Agrovoltaicos sin Fronteras •
                    <span data-i18n="footer.note">Bilingual, community-driven seminar on agrivoltaics in Latin
                        America.</span>
                </div>
                <div style="display: flex; align-items: center;">
                    <a href="https://biosphere2.org/research/research-initiatives/agrivoltaics" target="_blank"
                        rel="noopener noreferrer" style="margin-left: 8px;">
                        <img src="static/b2ua.jpg" alt="Biosphere 2 Agrivoltaics"
                            style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                    </a>
                    <a href="https://www.ier.unam.mx/ParcelaAgrovoltaica.html" target="_blank"
                        rel="noopener noreferrer" style="margin-left: 8px;">
                        <img src="static/unam.png" alt="UNAM"
                            style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                    </a>
                </div>
            </small>
        </div>
    </footer>

    <script type="module">
        // MODIFIED: Imports changed to match the working pages' pattern
        import { initAuth, signOut, authState } from './auth.js';

        const state = { language: localStorage.getItem("lang") || "en" };
        const t = {
            en: {
                tagline: "A seminar series to share advances in agrivoltaics in the Americas",
                nav: { schedule: "Schedule", about: "About", admin: "Admin", archive: "Archive" },
                auth: { signin: "Sign in", signout: "Sign out" },
                footer: { note: "Bilingual, community-driven seminar on agrivoltaics in Latin America." },
            },
            es: {
                tagline: "Una serie de seminarios para compartir avances en agrovoltaicos en las Américas",
                nav: { schedule: "Calendario", about: "Acerca de", admin: "Admin", archive: "Archivo" },
                auth: { signin: "Iniciar sesión", signout: "Cerrar sesión" },
                footer: { note: "Seminario bilingüe y comunitario sobre agrofotovoltaica en América Latina." },
            },
        };

        const $ = (sel) => document.querySelector(sel);
        function tr(key, fallback = "") {
            const lang = state.language;
            const parts = key.split(".");
            let obj = t[lang];
            for (const p of parts) obj = obj?.[p];
            return obj ?? fallback;
        }

        function applyI18n() {
            document.documentElement.lang = state.language;
            document.querySelectorAll("[data-i18n]").forEach((el) => {
                el.textContent = tr(el.dataset.i18n, el.textContent);
            });
            document.querySelectorAll(".lang-switch-slider").forEach(el => el.dataset.lang = state.language);
        }

        // --- NEW: Added UI functions locally to ensure correct timing ---
        function setupMobileMenu() {
            const mobileNavOverlay = $("#mobileNavOverlay");
            const desktopNav = document.querySelector('.header-grid .nav');
            if (!mobileNavOverlay || !desktopNav) return;
            mobileNavOverlay.innerHTML = '';
            const closeBtn = document.createElement('button');
            closeBtn.className = 'mobile-nav-close-btn';
            closeBtn.setAttribute('aria-label', 'Close menu');
            closeBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
            const content = desktopNav.cloneNode(true);
            content.id = '';
            const langSwitchMobile = content.querySelector('#langSwitchDesktop');
            if (langSwitchMobile) langSwitchMobile.id = 'langSwitchMobile';
            mobileNavOverlay.appendChild(closeBtn);
            mobileNavOverlay.appendChild(content);
            closeBtn.addEventListener('click', closeMenu);
            mobileNavOverlay.addEventListener('click', (e) => { if (e.target === mobileNavOverlay) closeMenu(); });
            langSwitchMobile?.addEventListener('click', handleLangSwitch);
            content.querySelector("#btnSignOut")?.addEventListener("click", () => signOut());
            content.querySelector("#btnProfile")?.addEventListener("click", () => window.location.href = 'profile.html');
        }

        function openMenu() {
            const mobileMenuBtn = $("#mobileMenuBtn"), mobileNavOverlay = $("#mobileNavOverlay");
            mobileNavOverlay.classList.add("is-open"); document.body.classList.add("menu-open");
            mobileMenuBtn.setAttribute("aria-expanded", "true");
            mobileMenuBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`;
        }
        function closeMenu() {
            const mobileMenuBtn = $("#mobileMenuBtn"), mobileNavOverlay = $("#mobileNavOverlay");
            mobileNavOverlay.classList.remove("is-open"); document.body.classList.remove("menu-open");
            mobileMenuBtn.setAttribute("aria-expanded", "false");
            mobileMenuBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>`;
        }

        function renderHeader() {
            const btnSignIn = $("#btnSignIn"), btnSignOut = $("#btnSignOut"), btnAdmin = $("#btnAdmin"), userName = $("#userName"), btnProfile = $("#btnProfile");
            const isOrganizer = ["organizer", "admin"].includes(authState.profile?.role);
            if (authState.session) {
                btnSignIn.style.display = "none"; btnSignOut.style.display = "inline-block";
                btnProfile.style.display = "grid"; userName.style.display = "inline";
                userName.textContent = authState.profile?.full_name || authState.profile?.username || "";
                $("#userInitial").textContent = (authState.profile?.full_name || "U").charAt(0).toUpperCase();
                if (btnAdmin) btnAdmin.style.display = isOrganizer ? "inline-block" : "none";
            } else {
                btnSignIn.style.display = "inline-block"; btnSignOut.style.display = "none";
                btnProfile.style.display = "none"; userName.style.display = "none";
                if (btnAdmin) btnAdmin.style.display = "none";
            }
            // CRITICAL: Rebuild the mobile menu every time the header is rendered.
            setupMobileMenu();
        }

        function handleLangSwitch() {
            state.language = state.language === "en" ? "es" : "en";
            localStorage.setItem("lang", state.language);
            applyI18n();
            renderHeader(); // Re-render header to update text and mobile menu
        }

        function wireUI() {
            $("#langSwitchDesktop")?.addEventListener('click', handleLangSwitch);
            $("#mobileMenuBtn")?.addEventListener("click", () => {
                const overlay = $("#mobileNavOverlay");
                if (overlay && !overlay.classList.contains('is-open')) openMenu();
                else closeMenu();
            });
            $("#btnSignOut")?.addEventListener("click", () => signOut());
            $("#btnProfile")?.addEventListener("click", () => window.location.href = 'profile.html');
            $("#year").textContent = new Date().getFullYear();
        }

        // MODIFIED: Main execution logic now matches the working pages.
        (async function main() {
            applyI18n();
            wireUI();
            await initAuth({
                onAuthReady: renderHeader, // Render header once auth state is initially known
                onAuthChange: renderHeader // Re-render header if user logs in or out
            });
        })();
    </script>
</body>

</html>